var rm={};rm.showRightMenu=function(t,e=0,o=0){var i=$("#rightMenu");i.css("top",e+"px").css("left",o+"px"),t?(stopMaskScroll(),i.show()):i.hide()};var rmWidth=$("#rightMenu").width(),rmHeight=$("#rightMenu").height();rm.reloadrmSize=function(){rmWidth=$("#rightMenu").width(),rmHeight=$("#rightMenu").height()};var domhref="",domImgSrc="",selectTextNow="";function selceText(){var t;selectTextNow=(t=document.selection?document.selection.createRange().text:window.getSelection()+"")?t:""}function removeRightMenu(){rm.showRightMenu(!1),$("#rightmenu-mask").attr("style","display: none")}function stopMaskScroll(){if(document.getElementById("rightmenu-mask")){var t=document.getElementById("rightmenu-mask");t.addEventListener("mousewheel",function(t){removeRightMenu()},!1)}if(document.getElementById("rightMenu")){var t=document.getElementById("rightMenu");t.addEventListener("mousewheel",function(t){removeRightMenu()},!1)}}function switchDarkMode(){removeRightMenu();let t="dark"===document.documentElement.getAttribute("data-theme")?"dark":"light";"light"===t?(activateDarkMode(),saveToLocal.set("theme","dark",2),void 0!==GLOBAL_CONFIG.Snackbar&&btf.snackbarShow(GLOBAL_CONFIG.Snackbar.day_to_night)):(activateLightMode(),saveToLocal.set("theme","light",2),void 0!==GLOBAL_CONFIG.Snackbar&&btf.snackbarShow(GLOBAL_CONFIG.Snackbar.night_to_day)),"function"==typeof utterancesTheme&&utterancesTheme(),"object"==typeof FB&&window.loadFBComment(),window.DISQUS&&document.getElementById("disqus_thread").children.length&&setTimeout(()=>window.disqusReset(),200)}function copyUrl(t){$("body").after("<input id='copyVal'></input>");var e=document.getElementById("copyVal");e.value=t,e.select(),e.setSelectionRange(0,e.value.length),document.execCommand("copy"),$("#copyVal").remove()}function copyPageUrl(){copyUrl(window.location.href),btf.snackbarShow("复制本页链接地址成功"),removeRightMenu()}function rightmenuCopyText(t,e="no-add"){var o;let i=GLOBAL_CONFIG.copyright;o="add-copyright"==e&&t.length>i.limitCount?t+"\n\n\n"+i.languages.author+"\n"+i.languages.link+window.location.href+"\n"+i.languages.source+"\n"+i.languages.info:t,navigator.clipboard&&navigator.clipboard.writeText(o),removeRightMenu()}function imageToBlob(t){console.log(t);let e=new Image;image.crossOrigin="Anonymous";let o=document.createElement("canvas"),i=o.getContext("2d");return e.crossOrigin="",e.src=t,new Promise(t=>{e.onload=function(){o.width=this.naturalWidth,o.height=this.naturalHeight,i.drawImage(this,0,0),o.toBlob(e=>{t(e)},"image/png",.75)}})}async function copyImage(t){let e=await imageToBlob(t),o=new ClipboardItem({"image/png":e});navigator.clipboard.write([o])}function writeClipImg(t){if(removeRightMenu(),-1==t.indexOf(location.host)){btf.snackbarShow("图片不同源，由于CORS限制，将无法提取位图！");return}btf.snackbarShow("正在下载中，请稍后",!1,1e4),!1==rm.downloadimging&&(rm.downloadimging=!0,setTimeout(function(){copyImage(t),btf.snackbarShow("复制成功！图片已添加盲水印，请遵守版权协议"),rm.downloadimging=!1},"10000"))}function downloadImage(t,e){removeRightMenu(),setTimeout(function(){var o=document.createElement("a"),i=new MouseEvent("click");o.download=e||"photo",o.href=t,o.click(),o.dispatchEvent(i),rm.downloadimging=!1},2e3)}function searchBaidu(){btf.snackbarShow("即将跳转到百度搜索"),setTimeout(function(){window.open("https://www.baidu.com/s?wd="+selectTextNow)},"2000"),removeRightMenu()}document.onmouseup=document.ondbclick=selceText,window.oncontextmenu=function(t){if(document.body.clientWidth>768){if(t.ctrlKey)return!0;var e=t.clientX+10,o=t.clientY,i=$(".rightMenuNormal"),c=$(".rightMenuOther"),s=$(".rightMenuPlugin"),r=$("#menu-copytext"),a=$("#menu-commenttext"),l=$("#menu-newwindow"),h=$("#menu-copylink"),m=$("#menu-copyimg"),u=$("#menu-downloadimg"),d=$("#menu-search"),g=$("#menu-searchBaidu"),p=$("#menu-readmode"),_=$("#menu-goto-comment"),y=t.target.href,f=t.target.currentSrc,w=location.href.includes("articles"),z=!1;return i.show(),c.show(),document.getElementById("post")||document.getElementById("page")?_.show():_.hide(),selectTextNow&&window.getSelection()?(z=!0,r.show(),a.show(),d.show(),g.show(),c.hide()):(r.hide(),a.hide(),g.hide(),d.hide()),y||f?(z=!0,l.show(),h.show(),c.hide(),y&&(domhref=y),f?(domImgSrc=f,domhref=f,m.show(),u.show()):(m.hide(),u.hide())):(m.hide(),u.hide(),l.hide(),h.hide()),w?p.show():p.hide(),z?s.show():s.hide(),rm.reloadrmSize(),e+rmWidth>window.innerWidth&&(e-=rmWidth),o+rmHeight>window.innerHeight&&(o-=rmHeight),rm.showRightMenu(!0,o,e),$("#rightmenu-mask").attr("style","display: flex"),!1}},$("#menu-backward").on("click",function(){window.history.back()}),$("#menu-forward").on("click",function(){window.history.forward()}),$("#menu-refresh").on("click",function(){window.location.reload()}),$("#menu-darkmode").on("click",function(){switchDarkMode()}),$("#menu-home").on("click",function(){window.location.href=window.location.origin}),$(".menu-link").on("click",function(){removeRightMenu()}),rm.downloadimging=!1;insertAtCaret:(t,e)=>{let o=t.selectionStart,i=t.selectionEnd;if(document.selection){var c;t.focus(),document.selection.createRange().text=e,t.focus()}else if(o||"0"==o){var s=t.scrollTop;t.value=t.value.substring(0,o)+e+t.value.substring(i,t.value.length),t.focus(),t.selectionStart=o+e.length,t.selectionEnd=o+e.length,t.scrollTop=s}else t.value+=e,t.focus()};function switchReadMode(t){var e;let o=document.body;function i(){o.classList.remove("read-mode"),e.remove(),e.removeEventListener("click",i)}0==t?(o.classList.add("read-mode"),(e=document.createElement("button")).type="button",e.className="fas fa-sign-out-alt exit-readmode",o.appendChild(e),e.addEventListener("click",i)):i(),removeRightMenu()}function replaceAll(t,e,o){return t.split(e).join(o)}function rightMenuCommentText(t){removeRightMenu();var e=document.getElementsByClassName("el-textarea__inner")[0],o=document.createEvent("HTMLEvents");o.initEvent("input",!0,!0);var i=replaceAll(t,"\n","\n> ");e.value="> "+i+"\n\n",e.dispatchEvent(o);var c=document.querySelector("#post-comment").offsetTop;window.scrollTo(0,c-80),e.focus(),e.setSelectionRange(-1,-1)}$("#menu-copy").on("click",function(){copyPageUrl()}),$("#menu-newwindow").on("click",function(){window.open(domhref),removeRightMenu()}),$("#menu-copylink").on("click",function(){rightmenuCopyText(domhref),btf.snackbarShow("已复制链接地址")}),$("#menu-copyimg").on("click",function(){writeClipImg(domImgSrc)}),$("#menu-downloadimg").on("click",function(){downloadImage(domImgSrc,"tzy1997")}),$("#menu-copytext").on("click",function(){rightmenuCopyText(selectTextNow,"add-copyright"),btf.snackbarShow("复制成功"),removeRightMenu()}),$("#menu-searchBaidu").on("click",function(){searchBaidu()}),$("#menu-commenttext").on("click",function(){rightMenuCommentText(selectTextNow)}),$("#menu-print").on("click",function(){removeRightMenu(),window.print()}),$("#menu-readmode").on("click",function(){let t=document.body.classList.length;switchReadMode(t)}),$("#menu-goto-comment").on("click",function(){removeRightMenu()}),$("#menu-radompage").on("click",function(){var t=["https://tzy1997.com/articles/vu9856es","https://tzy1997.com/articles/vu0326ep","https://tzy1997.com/articles/co0410de","https://tzy1997.com/articles/amo9485t","https://tzy1997.com/articles/bd1314sh","https://tzy1997.com/articles/cs0504xn","https://tzy1997.com/articles/ut0927il","https://tzy1997.com/articles/0xiipgum","https://tzy1997.com/articles/ele265ui","https://tzy1997.com/articles/fe0417mn","https://tzy1997.com/articles/fi5487lt","https://tzy1997.com/articles/gi0506hb","https://tzy1997.com/articles/do0228ck","https://tzy1997.com/articles/js0320ub","https://tzy1997.com/articles/kfwr2gpa","https://tzy1997.com/articles/wb0502st","https://tzy1997.com/articles/contra128","https://tzy1997.com/articles/e13t14zy","https://tzy1997.com/articles/db0307ver","https://tzy1997.com/articles/js0417es","https://tzy1997.com/articles/jo4116ba","https://tzy1997.com/articles/np2021sm","https://tzy1997.com/articles/hexo1600","https://tzy1997.com/articles/hexo1601","https://tzy1997.com/articles/hexo1602","https://tzy1997.com/articles/hexo1603","https://tzy1997.com/articles/hexo1604","https://tzy1997.com/articles/hexo1605","https://tzy1997.com/articles/hexo1606","https://tzy1997.com/articles/hexo1607","https://tzy1997.com/articles/hexo1608","https://tzy1997.com/articles/hexo1609","https://tzy1997.com/articles/hexo1610","https://tzy1997.com/articles/hexo1611","https://tzy1997.com/articles/hexo1612","https://tzy1997.com/articles/hexo1613","https://tzy1997.com/articles/hexo1614","https://tzy1997.com/articles/hexo541u","https://tzy1997.com/articles/Ha5487ng","https://tzy1997.com/articles/io0411sc","https://tzy1997.com/articles/jsnb9527","https://tzy1997.com/articles/jsnb9528","https://tzy1997.com/articles/jsnb9529","https://tzy1997.com/articles/jsnb9530","https://tzy1997.com/articles/jsnb9531","https://tzy1997.com/articles/jsnb9532","https://tzy1997.com/articles/jsnb9533","https://tzy1997.com/articles/jsnb9534","https://tzy1997.com/articles/jsnb9535","https://tzy1997.com/articles/jsnb9536","https://tzy1997.com/articles/jsnb9537","https://tzy1997.com/articles/jsnb9538","https://tzy1997.com/articles/jsnb9539","https://tzy1997.com/articles/jsnb9540","https://tzy1997.com/articles/jsnb9541","https://tzy1997.com/articles/jsnb9542","https://tzy1997.com/articles/jsnb9543","https://tzy1997.com/articles/jsnb9544","https://tzy1997.com/articles/hyeccjmu","https://tzy1997.com/articles/rea323su","https://tzy1997.com/articles/sql228ba","https://tzy1997.com/articles/soc145ket","https://tzy1997.com/articles/xi2mpxmd","https://tzy1997.com/articles/zt1442re","https://tzy1997.com/articles/we0522bs",];n=Math.floor(Math.random()*t.length),location.href=t[n],window.href=n,removeRightMenu()}),$("#rightmenu-mask").on("click",function(){removeRightMenu()}),$("#rightmenu-mask").contextmenu(function(){return removeRightMenu(),!1}),$(".joe_wallpaper__type-list>li").on("click",function(){$(this).addClass("active"),$(this).siblings().removeClass("active");var t="#item-"+$(this).attr("data-cid");$(t).addClass("item-show").siblings().removeClass("item-show")});